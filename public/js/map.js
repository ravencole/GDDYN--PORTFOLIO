function formatDate(e){var i=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sept","Oct","Nov","Dec"];e=e.split(":");var t={year:e[0],month:e[1],day:e[2]},a=/0(\d)/;return a.test(t.month)&&(t.month=t.month.replace(a,"$1")),Number(t.month),t.month=i[t.month-1],t.month+" "+t.day+", "+t.year}function dumbTime(e){this.time=e;var i=/(\d{2}):(\d{2}):(\d{2})/,t=i.exec(this.time);this.hour=t[1],this.minute=t[2],this.second=t[3],this.amPm="",this.formatHour=function(){var e=/0(\d)/;e.test(this.hour)&&(this.hour=this.hour.replace(e,"$1")),Number(this.hour),this.hour>12?(this.hour=this.hour-12,this.hour.toString()):0==this.hour?(this.hour=12,this.hour.toString()):this.hour.toString()},this.formatAmPm=function(){t[1]>11?this.amPm="pm":this.amPm="am"},this.getTime=function(){var e={hour:this.hour,minute:this.minute,second:this.second,amPm:this.amPm};return e}}function initMap(){var e=new google.maps.StyledMapType([{featureType:"administrative",elementType:"labels.text.fill",stylers:[{color:"#444444"}]},{featureType:"landscape",elementType:"all",stylers:[{color:"#f2f2f2"}]},{featureType:"poi",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"all",stylers:[{saturation:-100},{lightness:45}]},{featureType:"road.highway",elementType:"all",stylers:[{visibility:"simplified"}]},{featureType:"road.arterial",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"all",stylers:[{color:"#ffffff"},{visibility:"on"}]},{name:"Richmond Style"}]),i="richmond_style";map=new google.maps.Map(document.getElementById("map"),{center:{lat:37.558588,lng:-77.476961},zoom:14,mapTypeControlOptions:{mapTypeIds:[google.maps.MapTypeId.ROADMAP,i]}}),map.mapTypes.set(i,e),map.setMapTypeId(i)}function setMarkers(e){function i(e){for(var i=alleyPics.length-1;i>=0;i--)if(alleyPics[i].id===e)var t=alleyPics[i];var a=new dumbTime(t.time);a.formatHour(),a.formatAmPm();var o=a.getTime(),n="/images/alley_images/"+t.name;$("#image-box").css({height:u,width:imageWidth,"background-image":'url("'+n+'")'}),$("#image-box").empty().append('<div class="image-box-info"><div class="info-subject">'+t.latitude+'</div><div class="info-subject">'+t.longitude+'</div><div class="info-subject">'+formatDate(t.date)+'</div><div class="info-subject">'+o.hour+":"+o.minute+" "+o.amPm+"</div></div>")}for(var t={url:"",size:new google.maps.Size(20,32),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(0,32)},a=function(){var e=Math.floor(10*Math.random()+1);return"/images/map_icons/icon"+e+".png"},o=new google.maps.InfoWindow,n=0;n<alleyPics.length;n++){t.url=a();var s=alleyPics[n],r='<div id="iw-container"><img width="300px" src="/images/alley_images/'+s.name+'"></div>';s.latitude=Number(s.latitude),s.longitude=Number(s.longitude);var l,m=new google.maps.Marker({position:{lat:s.latitude,lng:s.longitude},map:e,icon:t,shape:shape,id:s.id});google.maps.event.addListener(m,"click",function(e,a,o){return function(){if(l){var a=/active/,o=l.icon.url,n="visited";t.url=o.replace(a,n),l.setIcon(t)}i(e.id);var s=/((icon\d\d?)([^\.]?)+)/,r=e.icon.url,m="$2-active";t.url=r.replace(s,m),e.setIcon(t),l=e}}(m,r,o));var u=window.innerHeight;imageWidth=6*u/4.5}}var map,alleyPics,shape={coords:[1,1,1,20,18,20,18,1],type:"poly"};$.getJSON("/alley",function(e){alleyPics=e,setMarkers(map)}),$("#image-box").hover(function(){$(".image-box-info").fadeIn(250).css("display","flex")},function(){$(".image-box-info").fadeOut(250)});